@import '~@fluentui/react/dist/sass/References.scss';

.multiCalendarAggregator {
  overflow: hidden;
  padding: 1.25rem;
  color: "[theme:bodyText, default: #323130]";
  color: var(--bodyText);
  background-color: "[theme:bodyBackground, default: #ffffff]";
  border-radius: 8px;
  box-shadow: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108);
  transition: all 0.2s ease-in-out;

  &:hover {
    box-shadow: 0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108);
  }

  .welcome {
    text-align: center;
    margin: 0 0 2rem 0;
    
    .welcomeImage {
      width: 100%;
      max-width: 420px;
      height: auto;
      margin: 0 auto 1rem auto;
      display: block;
    }

    .title {
      font-size: 1.75rem;
      font-weight: 600;
      color: "[theme:themePrimary, default: #0078d4]";
      margin-bottom: 0.5rem;
    }

    .subTitle {
      font-size: 1rem;
      color: "[theme:neutralSecondary, default: #605e5c]";
      margin-bottom: 1.5rem;
    }

    .description {
      font-size: 0.875rem;
      color: "[theme:neutralTertiary, default: #a19f9d]";
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.5;
    }
  }

  .container {
    min-height: 600px;
    position: relative;
    background: "[theme:neutralLighterAlt, default: #faf9f8]";
    border-radius: 6px;
    border: 1px solid "[theme:neutralLight, default: #edebe9]";
  }

  .header {
    background: "[theme:white, default: #ffffff]";
    padding: 1rem 1.25rem;
    border-bottom: 1px solid "[theme:neutralLight, default: #edebe9]";
    border-radius: 6px 6px 0 0;
    
    .headerTitle {
      font-size: 1.5rem;
      font-weight: 600;
      color: "[theme:themePrimary, default: #0078d4]";
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      
      .headerIcon {
        font-size: 1.75rem;
        color: "[theme:themePrimary, default: #0078d4]";
      }
    }

    .headerSubtitle {
      font-size: 0.875rem;
      color: "[theme:neutralSecondary, default: #605e5c]";
      margin: 0.25rem 0 0 0;
    }

    .headerStats {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 0.875rem;
      color: "[theme:neutralSecondary, default: #605e5c]";
      
      .stat {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        
        .statIcon {
          font-size: 0.75rem;
          color: "[theme:themePrimary, default: #0078d4]";
        }
      }
    }
  }

  .commandBar {
    background: "[theme:white, default: #ffffff]";
    border-radius: 6px;
    margin-bottom: 1rem;
    box-shadow: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108);
    
    // Override Fluent UI CommandBar styles
    :global(.ms-CommandBar) {
      border-radius: 6px;
      border: 1px solid "[theme:neutralLight, default: #edebe9]";
    }
  }

  .viewSelector {
    background: "[theme:white, default: #ffffff]";
    border-radius: 6px;
    margin-bottom: 1rem;
    box-shadow: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108);
    padding: 0.5rem 1rem;
    
    :global(.ms-Pivot) {
      .ms-Pivot-link {
        padding: 0.75rem 1rem;
        font-weight: 500;
        transition: all 0.2s ease;
        
        &:hover {
          background-color: "[theme:neutralLighterAlt, default: #faf9f8]";
        }
        
        &.is-selected {
          color: "[theme:themePrimary, default: #0078d4]";
          
          &::before {
            background-color: "[theme:themePrimary, default: #0078d4]";
            height: 3px;
          }
        }
      }
    }
  }

  .calendarContainer {
    background: "[theme:white, default: #ffffff]";
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108);
    border: 1px solid "[theme:neutralLight, default: #edebe9]";
    
    // React Big Calendar overrides
    :global(.rbc-calendar) {
      font-family: '"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif';
      
      .rbc-header {
        background-color: "[theme:themePrimary, default: #0078d4]";
        color: "[theme:white, default: #ffffff]";
        font-weight: 600;
        padding: 0.75rem 0.5rem;
        border-bottom: none;
        font-size: 0.875rem;
      }

      .rbc-today {
        background-color: "[theme:themeLighter, default: #c7e0f4]";
      }

      .rbc-event {
        border-radius: 4px;
        border: none;
        font-weight: 500;
        font-size: 0.75rem;
        padding: 2px 6px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        transition: all 0.2s ease;
        
        &:hover {
          transform: translateY(-1px);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        
        &:focus {
          outline: 2px solid "[theme:themePrimary, default: #0078d4]";
          outline-offset: 1px;
        }
      }

      .rbc-month-view {
        border: none;
        
        .rbc-date-cell {
          padding: 0.25rem;
          
          &.rbc-off-range {
            color: "[theme:neutralTertiary, default: #a19f9d]";
            background-color: "[theme:neutralLighter, default: #f3f2f1]";
          }
        }
      }

      .rbc-day-bg {
        border-right: 1px solid "[theme:neutralLighter, default: #f3f2f1]";
        border-bottom: 1px solid "[theme:neutralLighter, default: #f3f2f1]";
        
        &:hover {
          background-color: "[theme:neutralLighterAlt, default: #faf9f8]";
        }
      }

      .rbc-time-view {
        .rbc-time-gutter {
          background-color: "[theme:neutralLighterAlt, default: #faf9f8]";
          border-right: 1px solid "[theme:neutralLight, default: #edebe9]";
          font-size: 0.75rem;
          color: "[theme:neutralSecondary, default: #605e5c]";
        }

        .rbc-time-slot {
          border-top: 1px solid "[theme:neutralLighter, default: #f3f2f1]";
        }

        .rbc-current-time-indicator {
          background-color: "[theme:red, default: #d13438]";
          height: 2px;
          
          &::before {
            content: '';
            position: absolute;
            left: -4px;
            top: -3px;
            width: 8px;
            height: 8px;
            background-color: "[theme:red, default: #d13438]";
            border-radius: 50%;
          }
        }
      }

      .rbc-toolbar {
        padding: 1rem;
        background-color: "[theme:neutralLighterAlt, default: #faf9f8]";
        border-bottom: 1px solid "[theme:neutralLight, default: #edebe9]";
        
        .rbc-btn-group {
          button {
            background: "[theme:white, default: #ffffff]";
            border: 1px solid "[theme:neutralLight, default: #edebe9]";
            color: "[theme:neutralPrimary, default: #323130]";
            padding: 0.5rem 1rem;
            font-weight: 500;
            transition: all 0.2s ease;
            
            &:hover {
              background-color: "[theme:neutralLighterAlt, default: #faf9f8]";
              border-color: "[theme:themePrimary, default: #0078d4]";
            }
            
            &.rbc-active {
              background-color: "[theme:themePrimary, default: #0078d4]";
              color: "[theme:white, default: #ffffff]";
              border-color: "[theme:themePrimary, default: #0078d4]";
            }
          }
        }
        
        .rbc-toolbar-label {
          font-size: 1.25rem;
          font-weight: 600;
          color: "[theme:neutralPrimary, default: #323130]";
        }
      }
    }
  }

  .loadingContainer {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 400px;
    background: "[theme:white, default: #ffffff]";
    border-radius: 6px;
    
    .loadingIcon {
      margin-bottom: 1rem;
    }
    
    .loadingText {
      color: "[theme:neutralSecondary, default: #605e5c]";
      font-size: 1rem;
      font-weight: 500;
    }
  }

  .errorContainer {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 400px;
    background: "[theme:white, default: #ffffff]";
    border-radius: 6px;
    padding: 2rem;
    text-align: center;
    
    .errorIcon {
      font-size: 3rem;
      color: "[theme:red, default: #d13438]";
      margin-bottom: 1rem;
    }
    
    .errorTitle {
      font-size: 1.25rem;
      font-weight: 600;
      color: "[theme:neutralPrimary, default: #323130]";
      margin-bottom: 0.5rem;
    }
    
    .errorMessage {
      color: "[theme:neutralSecondary, default: #605e5c]";
      font-size: 0.875rem;
      margin-bottom: 1.5rem;
      max-width: 400px;
    }
    
    .errorActions {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
    }
  }

  .emptyState {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 400px;
    background: "[theme:white, default: #ffffff]";
    border-radius: 6px;
    padding: 2rem;
    text-align: center;
    
    .emptyIcon {
      font-size: 4rem;
      color: "[theme:neutralTertiary, default: #a19f9d]";
      margin-bottom: 1.5rem;
    }
    
    .emptyTitle {
      font-size: 1.5rem;
      font-weight: 600;
      color: "[theme:neutralSecondary, default: #605e5c]";
      margin-bottom: 0.75rem;
    }
    
    .emptyMessage {
      color: "[theme:neutralTertiary, default: #a19f9d]";
      font-size: 1rem;
      margin-bottom: 2rem;
      max-width: 400px;
      line-height: 1.5;
    }
    
    .emptyActions {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
    }
  }

  // Responsive design
  @media (max-width: 768px) {
    padding: 0.75rem;
    
    .header {
      padding: 0.75rem 1rem;
      
      .headerTitle {
        font-size: 1.25rem;
      }
      
      .headerStats {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
        
        .stat {
          font-size: 0.75rem;
        }
      }
    }
    
    .calendarContainer {
      :global(.rbc-toolbar) {
        padding: 0.75rem;
        flex-direction: column;
        gap: 0.75rem;
        
        .rbc-toolbar-label {
          font-size: 1rem;
        }
        
        .rbc-btn-group {
          button {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
          }
        }
      }
      
      :global(.rbc-header) {
        padding: 0.5rem 0.25rem;
        font-size: 0.75rem;
      }
    }
  }

  // Dark theme support
  @media (prefers-color-scheme: dark) {
    background-color: "[theme:neutralDark, default: #201f1e]";
    color: "[theme:white, default: #ffffff]";
    
    .container {
      background: "[theme:neutralDark, default: #201f1e]";
      border-color: "[theme:neutralQuaternary, default: #484644]";
    }
    
    .header {
      background: "[theme:neutralDark, default: #201f1e]";
      border-color: "[theme:neutralQuaternary, default: #484644]";
    }
    
    .calendarContainer {
      background: "[theme:neutralDark, default: #201f1e]";
      border-color: "[theme:neutralQuaternary, default: #484644]";
    }
  }

  // High contrast support
  @media (prefers-contrast: high) {
    border: 2px solid;
    
    .calendarContainer {
      border: 2px solid;
    }
    
    :global(.rbc-event) {
      border: 1px solid !important;
    }
  }

  // Reduced motion support
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  // Print styles
  @media print {
    box-shadow: none;
    border: 1px solid #000;
    
    .commandBar,
    .viewSelector {
      display: none;
    }
    
    .calendarContainer {
      box-shadow: none;
      border: 1px solid #000;
    }
  }
}