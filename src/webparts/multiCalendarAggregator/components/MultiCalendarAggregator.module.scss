@import '~@fluentui/react/dist/sass/References.scss';

// Modern SharePoint Design System Variables
:root {
  // Fluent UI Semantic Colors
  --neutralPrimary: #323130;
  --neutralPrimaryAlt: #2f2e2d;
  --neutralSecondary: #605e5c;
  --neutralSecondaryAlt: #8a8886;
  --neutralTertiary: #a19f9d;
  --neutralTertiaryAlt: #c8c6c4;
  --neutralQuaternary: #d2d0ce;
  --neutralQuaternaryAlt: #e1dfdd;
  --neutralLight: #edebe9;
  --neutralLighter: #f3f2f1;
  --neutralLighterAlt: #faf9f8;
  --white: #ffffff;
  --black: #000000;

  // Theme Colors (Adaptive to SharePoint theme)
  --themeDarker: #004578;
  --themeDark: #005a9e;
  --themeDarkAlt: #106ebe;
  --themePrimary: #0078d4;
  --themeSecondary: #2b88d8;
  --themeTertiary: #71afe5;
  --themeLight: #c7e0f4;
  --themeLighter: #deecf9;
  --themeLighterAlt: #eff6fc;

  // Semantic Colors
  --errorText: #a4262c;
  --errorBackground: #fdf3f4;
  --successText: #107c10;
  --successBackground: #f3f9f1;
  --warningText: #797673;
  --warningBackground: #fff4ce;
  --severeWarningText: #d83b01;
  --severeWarningBackground: #fed9cc;
  --infoText: #0078d4;
  --infoBackground: #f3f9ff;

  // Modern Shadows (Microsoft Fluent)
  --shadow2: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.12), 0 0 0 0.0625rem rgba(0, 0, 0, 0.07);
  --shadow4: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.11), 0 0.125rem 0.5rem rgba(0, 0, 0, 0.13);
  --shadow8: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.13), 0 0.5rem 1rem rgba(0, 0, 0, 0.11);
  --shadow16: 0 0.5rem 1rem rgba(0, 0, 0, 0.13), 0 1rem 2rem rgba(0, 0, 0, 0.11);
  --shadow64: 0 1.5rem 3rem rgba(0, 0, 0, 0.13), 0 2rem 4rem rgba(0, 0, 0, 0.11);

  // Animation Curves (Microsoft Fluent Motion)
  --easeAccelerate: cubic-bezier(0.7, 0, 1, 0.5);
  --easeDecelerate: cubic-bezier(0.1, 0.9, 0.2, 1);
  --easeMaxOut: cubic-bezier(0, 0, 0, 1);
  --easeLinear: cubic-bezier(0, 0, 1, 1);
  --easeStandard: cubic-bezier(0.8, 0, 0.2, 1);

  // Typography Scale
  --fontSizeXSmall: 0.625rem;   // 10px
  --fontSizeSmall: 0.75rem;     // 12px
  --fontSizeMedium: 0.875rem;   // 14px
  --fontSizeLarge: 1rem;        // 16px
  --fontSizeXLarge: 1.125rem;   // 18px
  --fontSizeXXLarge: 1.25rem;   // 20px
  --fontSizeXXXLarge: 1.75rem;  // 28px
  --fontSizeMegaLarge: 2.625rem; // 42px

  // Border Radius
  --borderRadiusSmall: 0.125rem;
  --borderRadiusMedium: 0.25rem;
  --borderRadiusLarge: 0.5rem;
  --borderRadiusXLarge: 0.75rem;

  // Spacing Scale
  --spacing2XS: 0.125rem;  // 2px
  --spacingXS: 0.25rem;    // 4px
  --spacingS1: 0.5rem;     // 8px
  --spacingS2: 0.75rem;    // 12px
  --spacingM: 1rem;        // 16px
  --spacingL1: 1.25rem;    // 20px
  --spacingL2: 1.5rem;     // 24px
  --spacingXL: 2rem;       // 32px
  --spacingXXL: 2.5rem;    // 40px
  --spacing3XL: 3rem;      // 48px
  --spacing4XL: 4rem;      // 64px

  // Z-Index Scale
  --zIndexContent: 0;
  --zIndexOverlay: 1000;
  --zIndexFlyout: 1010;
  --zIndexModal: 1020;
  --zIndexSnackbar: 1030;
  --zIndexTooltip: 1040;
}

// Dark theme overrides
[data-theme="dark"] {
  --neutralPrimary: #ffffff;
  --neutralSecondary: #d2d0ce;
  --neutralTertiary: #a19f9d;
  --neutralLight: #3c3c3c;
  --neutralLighter: #2f2f2f;
  --neutralLighterAlt: #252423;
  --white: #1b1a19;
  --themePrimary: #479ef5;
  --themeLight: #004c87;
  --themeLighter: #043862;
  --themeLighterAlt: #032338;
}

// High contrast theme
@media (prefers-contrast: high) {
  :root {
    --neutralPrimary: #000000;
    --neutralSecondary: #000000;
    --white: #ffffff;
    --themePrimary: #1aebff;
    --shadow2: 0 0 0 0.125rem #000000;
    --shadow4: 0 0 0 0.1875rem #000000;
    --shadow8: 0 0 0 0.25rem #000000;
  }
}

// Reduced motion preferences
@media (prefers-reduced-motion: reduce) {
  :root {
    --easeAccelerate: ease;
    --easeDecelerate: ease;
    --easeMaxOut: ease;
    --easeStandard: ease;
  }
  
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

// Main Calendar Component
.multiCalendarAggregator {
  position: relative;
  width: 100%;
  min-height: 40rem;
  font-family: 'Segoe UI', 'Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif;
  color: var(--neutralPrimary);
  background: var(--neutralLighterAlt);
  border-radius: var(--borderRadiusLarge);
  box-shadow: var(--shadow2);
  overflow: hidden;
  transition: box-shadow 200ms var(--easeDecelerate);

  &:hover {
    box-shadow: var(--shadow8);
  }

  &:focus-within {
    outline: 0.125rem solid var(--themePrimary);
    outline-offset: 0.125rem;
  }

  // Modern Header with Fluent Design
  .header {
    position: relative;
    background: linear-gradient(135deg, var(--white) 0%, var(--neutralLighterAlt) 100%);
    border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
    padding: var(--spacingL2);
    backdrop-filter: blur(1rem) saturate(180%);

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 0.25rem;
      background: linear-gradient(90deg, var(--themePrimary), var(--themeSecondary), var(--themeTertiary));
      border-radius: var(--borderRadiusLarge) var(--borderRadiusLarge) 0 0;
    }

    .headerContent {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--spacingL1);

      .titleSection {
        display: flex;
        align-items: center;
        gap: var(--spacingM);
        flex: 1;

        .titleIcon {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 2.5rem;
          height: 2.5rem;
          background: linear-gradient(135deg, var(--themePrimary), var(--themeSecondary));
          border-radius: var(--borderRadiusMedium);
          color: var(--white);
          font-size: var(--fontSizeLarge);
          box-shadow: var(--shadow4);
          position: relative;

          &::after {
            content: '';
            position: absolute;
            inset: -0.125rem;
            background: linear-gradient(135deg, var(--themePrimary), var(--themeSecondary));
            border-radius: calc(var(--borderRadiusMedium) + 0.125rem);
            z-index: -1;
            opacity: 0;
            transition: opacity 200ms var(--easeDecelerate);
          }

          &:hover::after {
            opacity: 0.2;
          }
        }

        .titleText {
          .title {
            font-size: var(--fontSizeXXLarge);
            font-weight: 600;
            color: var(--neutralPrimary);
            margin: 0;
            line-height: 1.2;
            letter-spacing: -0.02em;
          }

          .subtitle {
            font-size: var(--fontSizeMedium);
            color: var(--neutralSecondary);
            margin: 0;
            margin-top: var(--spacingXS);
            font-weight: 400;
          }
        }
      }

      .headerActions {
        display: flex;
        align-items: center;
        gap: var(--spacingS1);

        .syncStatus {
          display: flex;
          align-items: center;
          gap: var(--spacingS1);
          padding: var(--spacingS1) var(--spacingS2);
          background: var(--successBackground);
          color: var(--successText);
          border-radius: var(--borderRadiusSmall);
          font-size: var(--fontSizeSmall);
          font-weight: 500;

          &.syncing {
            background: var(--warningBackground);
            color: var(--warningText);
          }

          &.error {
            background: var(--errorBackground);
            color: var(--errorText);
          }

          .syncIcon {
            font-size: var(--fontSizeSmall);
            animation: pulse 2s infinite var(--easeDecelerate);
          }
        }

        .quickActions {
          display: flex;
          gap: var(--spacingXS);

          .quickAction {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            background: transparent;
            border: 0.0625rem solid var(--neutralQuaternary);
            border-radius: var(--borderRadiusMedium);
            color: var(--neutralSecondary);
            cursor: pointer;
            transition: all 200ms var(--easeDecelerate);
            position: relative;
            overflow: hidden;

            &::before {
              content: '';
              position: absolute;
              inset: 0;
              background: var(--themePrimary);
              opacity: 0;
              transition: opacity 200ms var(--easeDecelerate);
            }

            &:hover {
              border-color: var(--themePrimary);
              color: var(--themePrimary);
              transform: translateY(-0.0625rem);
              box-shadow: var(--shadow4);

              &::before {
                opacity: 0.05;
              }
            }

            &:active {
              transform: translateY(0);
            }

            i {
              position: relative;
              z-index: 1;
              font-size: var(--fontSizeMedium);
            }
          }
        }
      }
    }
  }

  // Modern Command Bar
  .commandBar {
    background: var(--white);
    border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
    position: relative;

    :global(.ms-CommandBar) {
      background: transparent;
      border: none;
      padding: var(--spacingS2) var(--spacingL2);

      .ms-CommandBar-primarySet {
        .ms-CommandBarItem {
          .ms-Button {
            background: transparent;
            border: 0.0625rem solid transparent;
            border-radius: var(--borderRadiusMedium);
            color: var(--neutralPrimary);
            font-weight: 500;
            height: 2rem;
            min-width: auto;
            padding: 0 var(--spacingS2);
            transition: all 200ms var(--easeDecelerate);
            position: relative;
            overflow: hidden;

            &::before {
              content: '';
              position: absolute;
              inset: 0;
              background: var(--themePrimary);
              opacity: 0;
              transition: opacity 200ms var(--easeDecelerate);
            }

            &:hover {
              background: var(--neutralLighterAlt);
              border-color: var(--neutralQuaternary);
              transform: translateY(-0.0625rem);

              &::before {
                opacity: 0.05;
              }
            }

            &:active {
              transform: translateY(0);
            }

            .ms-Button-icon {
              position: relative;
              z-index: 1;
              color: var(--themePrimary);
              margin-right: var(--spacingXS);
            }

            .ms-Button-textContainer {
              position: relative;
              z-index: 1;
            }

            &.is-disabled {
              opacity: 0.5;
              
              &:hover {
                transform: none;
                background: transparent;
              }
            }
          }
        }
      }

      .ms-CommandBar-secondarySet {
        .ms-SearchBox {
          width: 20rem;
          
          .ms-SearchBox-field {
            background: var(--neutralLighterAlt);
            border: 0.0625rem solid var(--neutralQuaternary);
            border-radius: var(--borderRadiusMedium);
            color: var(--neutralPrimary);
            font-size: var(--fontSizeMedium);
            padding: var(--spacingS1) var(--spacingS2);
            transition: all 200ms var(--easeDecelerate);

            &:focus {
              border-color: var(--themePrimary);
              box-shadow: 0 0 0 0.0625rem var(--themePrimary);
              background: var(--white);
            }

            &::placeholder {
              color: var(--neutralTertiary);
            }
          }

          .ms-SearchBox-icon {
            color: var(--neutralSecondary);
            
            &:hover {
              color: var(--themePrimary);
            }
          }
        }
      }
    }
  }

  // Modern View Selector
  .viewSelector {
    background: var(--white);
    border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
    padding: var(--spacingS2) var(--spacingL2) 0;

    :global(.ms-Pivot) {
      .ms-Pivot-link {
        padding: var(--spacingS2) var(--spacingL1);
        margin: 0 var(--spacingXS);
        border-radius: var(--borderRadiusMedium) var(--borderRadiusMedium) 0 0;
        color: var(--neutralSecondary);
        font-weight: 500;
        font-size: var(--fontSizeMedium);
        transition: all 200ms var(--easeDecelerate);
        position: relative;
        overflow: hidden;

        &::before {
          content: '';
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          height: 0.1875rem;
          background: var(--themePrimary);
          transform: scaleX(0);
          transition: transform 200ms var(--easeDecelerate);
        }

        &:hover {
          background: var(--neutralLighterAlt);
          color: var(--neutralPrimary);
        }

        &.is-selected {
          background: var(--neutralLighterAlt);
          color: var(--themePrimary);
          
          &::before {
            transform: scaleX(1);
          }
        }

        .ms-Pivot-linkContent {
          display: flex;
          align-items: center;
          gap: var(--spacingS1);

          .ms-Icon {
            font-size: var(--fontSizeMedium);
          }
        }
      }
    }
  }

  // Calendar Container with Modern Design
  .calendarContainer {
    background: var(--white);
    position: relative;
    min-height: 30rem;
    overflow: hidden;

    // React Big Calendar Modern Styling
    :global(.rbc-calendar) {
      font-family: inherit;
      color: var(--neutralPrimary);

      .rbc-toolbar {
        background: var(--neutralLighterAlt);
        border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
        padding: var(--spacingL1) var(--spacingL2);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: var(--spacingL1);

        .rbc-toolbar-label {
          font-size: var(--fontSizeXLarge);
          font-weight: 600;
          color: var(--neutralPrimary);
          margin: 0;
          letter-spacing: -0.01em;
          flex: 1;
          text-align: center;
        }

        .rbc-btn-group {
          display: flex;
          gap: var(--spacingXS);

          button {
            background: var(--white);
            border: 0.0625rem solid var(--neutralQuaternary);
            border-radius: var(--borderRadiusMedium);
            color: var(--neutralPrimary);
            font-weight: 500;
            font-size: var(--fontSizeMedium);
            padding: var(--spacingS1) var(--spacingL1);
            min-width: 4rem;
            height: 2.25rem;
            cursor: pointer;
            transition: all 200ms var(--easeDecelerate);
            position: relative;
            overflow: hidden;

            &::before {
              content: '';
              position: absolute;
              inset: 0;
              background: var(--themePrimary);
              opacity: 0;
              transition: opacity 200ms var(--easeDecelerate);
            }

            &:first-child {
              border-radius: var(--borderRadiusMedium) 0 0 var(--borderRadiusMedium);
              border-right: none;
            }

            &:last-child {
              border-radius: 0 var(--borderRadiusMedium) var(--borderRadiusMedium) 0;
              border-left: none;
            }

            &:not(:first-child):not(:last-child) {
              border-radius: 0;
              border-left: none;
              border-right: none;
            }

            &:hover {
              background: var(--neutralLighterAlt);
              border-color: var(--themePrimary);
              z-index: 1;
              transform: translateY(-0.0625rem);
              box-shadow: var(--shadow4);

              &::before {
                opacity: 0.05;
              }
            }

            &:active {
              transform: translateY(0);
            }

            &.rbc-active {
              background: var(--themePrimary);
              border-color: var(--themePrimary);
              color: var(--white);
              box-shadow: var(--shadow4);

              &:hover {
                background: var(--themeDark);
                border-color: var(--themeDark);
              }
            }

            span {
              position: relative;
              z-index: 1;
            }
          }
        }
      }

      // Month View Styling
      .rbc-month-view {
        border: none;

        .rbc-header {
          background: var(--neutralLighter);
          border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
          color: var(--neutralSecondary);
          font-weight: 600;
          font-size: var(--fontSizeSmall);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          padding: var(--spacingS2);
          text-align: center;

          + .rbc-header {
            border-left: 0.0625rem solid var(--neutralQuaternaryAlt);
          }
        }

        .rbc-month-row {
          border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);

          &:last-child {
            border-bottom: none;
          }
        }

        .rbc-date-cell {
          padding: var(--spacingS1);
          border-right: 0.0625rem solid var(--neutralQuaternaryAlt);
          min-height: 7rem;
          position: relative;
          transition: background-color 200ms var(--easeDecelerate);

          &:last-child {
            border-right: none;
          }

          &:hover {
            background: var(--neutralLighterAlt);
          }

          &.rbc-off-range {
            background: var(--neutralLighter);
            color: var(--neutralTertiary);
          }

          &.rbc-today {
            background: linear-gradient(135deg, var(--themeLighterAlt), var(--themeLighter));
            position: relative;

            &::before {
              content: '';
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              height: 0.1875rem;
              background: var(--themePrimary);
            }
          }

          .rbc-date-cell-date {
            font-weight: 500;
            color: var(--neutralPrimary);
            font-size: var(--fontSizeMedium);
            margin-bottom: var(--spacingS1);
          }

          &.rbc-today .rbc-date-cell-date {
            color: var(--themePrimary);
            font-weight: 600;
          }
        }
      }

      // Event Styling
      .rbc-event {
        background: var(--themePrimary);
        border: none;
        border-radius: var(--borderRadiusMedium);
        color: var(--white);
        font-size: var(--fontSizeSmall);
        font-weight: 500;
        padding: var(--spacingXS) var(--spacingS1);
        margin: 0.0625rem;
        box-shadow: var(--shadow2);
        cursor: pointer;
        transition: all 200ms var(--easeDecelerate);
        position: relative;
        overflow: hidden;

        &::before {
          content: '';
          position: absolute;
          inset: 0;
          background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1));
          opacity: 0;
          transition: opacity 200ms var(--easeDecelerate);
        }

        &:hover {
          transform: translateY(-0.0625rem) scale(1.02);
          box-shadow: var(--shadow8);

          &::before {
            opacity: 1;
          }
        }

        &:focus {
          outline: 0.125rem solid var(--white);
          outline-offset: 0.125rem;
        }

        .rbc-event-content {
          position: relative;
          z-index: 1;
          
          .event-time {
            font-size: var(--fontSizeXSmall);
            opacity: 0.9;
            margin-bottom: var(--spacing2XS);
          }

          .event-title {
            font-weight: 600;
            line-height: 1.2;
          }

          .event-location {
            font-size: var(--fontSizeXSmall);
            opacity: 0.8;
            margin-top: var(--spacing2XS);
          }
        }

        // Different event types
        &.event-meeting {
          background: var(--themePrimary);
        }

        &.event-appointment {
          background: var(--successText);
        }

        &.event-reminder {
          background: var(--severeWarningText);
        }

        &.event-all-day {
          background: var(--themeSecondary);
          border-radius: var(--borderRadiusSmall);
        }

        &.event-recurring {
          background: linear-gradient(135deg, var(--themePrimary), var(--themeSecondary));
          
          &::after {
            content: 'â†»';
            position: absolute;
            top: var(--spacingXS);
            right: var(--spacingXS);
            font-size: var(--fontSizeXSmall);
            opacity: 0.8;
          }
        }

        &.event-private {
          background: var(--neutralSecondary);
          
          &::after {
            content: 'ðŸ”’';
            position: absolute;
            top: var(--spacingXS);
            right: var(--spacingXS);
            font-size: var(--fontSizeXSmall);
          }
        }

        &.event-important {
          background: var(--errorText);
          box-shadow: 0 0 0 0.125rem rgba(164, 38, 44, 0.3);
          
          &::after {
            content: '!';
            position: absolute;
            top: var(--spacingXS);
            right: var(--spacingXS);
            font-size: var(--fontSizeSmall);
            font-weight: bold;
          }
        }
      }

      // Week View Styling
      .rbc-time-view {
        .rbc-time-header {
          border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);

          .rbc-header {
            background: var(--neutralLighter);
            border-left: 0.0625rem solid var(--neutralQuaternaryAlt);
            color: var(--neutralSecondary);
            font-weight: 600;
            font-size: var(--fontSizeSmall);
            text-align: center;
            padding: var(--spacingS2);

            &:first-child {
              border-left: none;
            }

            &.rbc-today {
              background: var(--themeLighter);
              color: var(--themePrimary);
            }
          }

          .rbc-today {
            background: var(--themeLighterAlt);
          }
        }

        .rbc-time-gutter {
          background: var(--neutralLighter);
          border-right: 0.0625rem solid var(--neutralQuaternaryAlt);

          .rbc-timeslot-group {
            border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);

            .rbc-time-slot {
              color: var(--neutralSecondary);
              font-size: var(--fontSizeSmall);
              font-weight: 500;
              text-align: center;
              border-top: 0.0625rem solid var(--neutralLighter);

              &:first-child {
                border-top: none;
              }
            }
          }
        }

        .rbc-time-content {
          .rbc-day-slot {
            border-left: 0.0625rem solid var(--neutralQuaternaryAlt);

            &:first-child {
              border-left: none;
            }

            .rbc-timeslot-group {
              border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);

              .rbc-time-slot {
                border-top: 0.0625rem solid var(--neutralLighter);
                transition: background-color 200ms var(--easeDecelerate);

                &:hover {
                  background: var(--neutralLighterAlt);
                }

                &:first-child {
                  border-top: none;
                }
              }
            }

            &.rbc-today {
              background: linear-gradient(to bottom, 
                var(--themeLighterAlt) 0%, 
                var(--neutralLighterAlt) 100%);
            }
          }
        }

        // Current time indicator
        .rbc-current-time-indicator {
          background: var(--errorText);
          height: 0.125rem;
          box-shadow: var(--shadow4);
          border-radius: var(--borderRadiusSmall);

          &::before {
            content: '';
            position: absolute;
            left: -0.375rem;
            top: -0.25rem;
            width: 0.75rem;
            height: 0.75rem;
            background: var(--errorText);
            border-radius: 50%;
            box-shadow: var(--shadow4);
          }
        }
      }

      // Agenda View (if using)
      .rbc-agenda-view {
        .rbc-agenda-table {
          .rbc-agenda-table-header {
             background: var(--neutralLighter);
             border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);

             .rbc-header {
               color: var(--neutralSecondary);
               font-weight: 600;
               font-size: var(--fontSizeSmall);
               text-transform: uppercase;
               letter-spacing: 0.05em;
               padding: var(--spacingS2) var(--spacingL1);
               border-right: 0.0625rem solid var(--neutralQuaternaryAlt);

               &:last-child {
                 border-right: none;
               }
             }
           }

           .rbc-agenda-content {
             .rbc-agenda-date-cell {
               background: var(--neutralLighterAlt);
               border-right: 0.0625rem solid var(--neutralQuaternaryAlt);
               border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
               padding: var(--spacingL1);
               font-weight: 600;
               color: var(--neutralPrimary);
               vertical-align: top;
               min-width: 8rem;
             }

             .rbc-agenda-time-cell {
               border-right: 0.0625rem solid var(--neutralQuaternaryAlt);
               border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
               padding: var(--spacingS2) var(--spacingL1);
               color: var(--neutralSecondary);
               font-size: var(--fontSizeSmall);
               white-space: nowrap;
               min-width: 6rem;
             }

             .rbc-agenda-event-cell {
               border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
               padding: var(--spacingS2) var(--spacingL1);
               color: var(--neutralPrimary);

               .event-title {
                 font-weight: 600;
                 margin-bottom: var(--spacingXS);
               }

               .event-details {
                 font-size: var(--fontSizeSmall);
                 color: var(--neutralSecondary);
               }
             }
           }
         }
       }
     }
   }

   // Custom Views
   .agendaView {
     padding: var(--spacingL2);
     max-height: 40rem;
     overflow-y: auto;

     .agendaHeader {
       display: flex;
       align-items: center;
       justify-content: space-between;
       margin-bottom: var(--spacingL1);
       padding-bottom: var(--spacingS2);
       border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);

       .agendaTitle {
         font-size: var(--fontSizeXLarge);
         font-weight: 600;
         color: var(--neutralPrimary);
         margin: 0;
       }

       .agendaControls {
         display: flex;
         align-items: center;
         gap: var(--spacingS2);

         .eventCount {
           color: var(--neutralSecondary);
           font-size: var(--fontSizeMedium);
           font-weight: 500;
         }
       }
     }

     .agendaGroup {
       margin-bottom: var(--spacingL2);

       .groupHeader {
         background: linear-gradient(135deg, var(--themeLighter), var(--themeLighterAlt));
         border: 0.0625rem solid var(--themeLight);
         border-radius: var(--borderRadiusMedium);
         padding: var(--spacingS2) var(--spacingL1);
         margin-bottom: var(--spacingS2);
         position: sticky;
         top: 0;
         z-index: var(--zIndexContent);

         .groupTitle {
           font-size: var(--fontSizeLarge);
           font-weight: 600;
           color: var(--themePrimary);
           margin: 0;
         }

         .groupSubtitle {
           font-size: var(--fontSizeSmall);
           color: var(--neutralSecondary);
           margin: 0;
           margin-top: var(--spacingXS);
         }
       }

       .groupEvents {
         display: flex;
         flex-direction: column;
         gap: var(--spacingS1);
       }
     }

     .eventCard {
       background: var(--white);
       border: 0.0625rem solid var(--neutralQuaternaryAlt);
       border-radius: var(--borderRadiusMedium);
       padding: var(--spacingL1);
       cursor: pointer;
       transition: all 200ms var(--easeDecelerate);
       position: relative;
       overflow: hidden;

       &::before {
         content: '';
         position: absolute;
         left: 0;
         top: 0;
         bottom: 0;
         width: 0.25rem;
         background: var(--themePrimary);
         transition: width 200ms var(--easeDecelerate);
       }

       &:hover {
         border-color: var(--themePrimary);
         box-shadow: var(--shadow8);
         transform: translateY(-0.0625rem);

         &::before {
           width: 0.375rem;
         }
       }

       &:active {
         transform: translateY(0);
       }

       .eventHeader {
         display: flex;
         align-items: flex-start;
         justify-content: space-between;
         margin-bottom: var(--spacingS1);

         .eventTitle {
           font-size: var(--fontSizeLarge);
           font-weight: 600;
           color: var(--neutralPrimary);
           margin: 0;
           line-height: 1.3;
           flex: 1;
         }

         .eventBadges {
           display: flex;
           gap: var(--spacingXS);
           margin-left: var(--spacingS2);

           .badge {
             display: flex;
             align-items: center;
             justify-content: center;
             width: 1.25rem;
             height: 1.25rem;
             border-radius: 50%;
             font-size: var(--fontSizeXSmall);
             color: var(--white);

             &.importance-high {
               background: var(--errorText);
             }

             &.recurring {
               background: var(--themeSecondary);
             }

             &.private {
               background: var(--neutralSecondary);
             }

             &.attendees {
               background: var(--successText);
             }
           }
         }
       }

       .eventTime {
         display: flex;
         align-items: center;
         gap: var(--spacingS1);
         color: var(--neutralSecondary);
         font-size: var(--fontSizeMedium);
         font-weight: 500;
         margin-bottom: var(--spacingS1);

         .timeIcon {
           color: var(--themePrimary);
         }
       }

       .eventDetails {
         display: flex;
         flex-wrap: wrap;
         gap: var(--spacingL1);

         .detail {
           display: flex;
           align-items: center;
           gap: var(--spacingS1);
           color: var(--neutralSecondary);
           font-size: var(--fontSizeSmall);

           .detailIcon {
             color: var(--themePrimary);
             font-size: var(--fontSizeSmall);
           }
         }
       }

       .eventDescription {
         margin-top: var(--spacingS2);
         color: var(--neutralSecondary);
         font-size: var(--fontSizeMedium);
         line-height: 1.4;
         display: -webkit-box;
         -webkit-line-clamp: 2;
         -webkit-box-orient: vertical;
         overflow: hidden;
       }
     }

     .emptyState {
       display: flex;
       flex-direction: column;
       align-items: center;
       justify-content: center;
       padding: var(--spacing4XL);
       text-align: center;

       .emptyIcon {
         font-size: 4rem;
         color: var(--neutralTertiary);
         margin-bottom: var(--spacingL1);
       }

       .emptyTitle {
         font-size: var(--fontSizeXLarge);
         font-weight: 600;
         color: var(--neutralSecondary);
         margin: 0 0 var(--spacingS2) 0;
       }

       .emptyMessage {
         font-size: var(--fontSizeLarge);
         color: var(--neutralTertiary);
         margin: 0 0 var(--spacingL2) 0;
         max-width: 24rem;
         line-height: 1.5;
       }

       .emptyActions {
         display: flex;
         gap: var(--spacingS2);
       }
     }
   }

   .timelineView {
     position: relative;
     height: 100%;
     overflow: hidden;

     .timelineHeader {
       background: var(--neutralLighter);
       border-bottom: 0.0625rem solid var(--neutralQuaternaryAlt);
       padding: var(--spacingL1) var(--spacingL2);
       position: sticky;
       top: 0;
       z-index: var(--zIndexContent);

       .timelineNavigation {
         display: flex;
         align-items: center;
         justify-content: space-between;

         .navigationButtons {
           display: flex;
           gap: var(--spacingXS);

           .navButton {
             display: flex;
             align-items: center;
             justify-content: center;
             width: 2.25rem;
             height: 2.25rem;
             background: var(--white);
             border: 0.0625rem solid var(--neutralQuaternary);
             border-radius: var(--borderRadiusMedium);
             color: var(--neutralPrimary);
             cursor: pointer;
             transition: all 200ms var(--easeDecelerate);

             &:hover {
               border-color: var(--themePrimary);
               color: var(--themePrimary);
               box-shadow: var(--shadow4);
             }

             &:active {
               transform: scale(0.95);
             }
           }
         }

         .currentPeriod {
           font-size: var(--fontSizeXLarge);
           font-weight: 600;
           color: var(--neutralPrimary);
           text-align: center;
           flex: 1;
         }

         .viewControls {
           display: flex;
           gap: var(--spacingS1);

           .viewToggle {
             padding: var(--spacingS1) var(--spacingL1);
             background: var(--white);
             border: 0.0625rem solid var(--neutralQuaternary);
             border-radius: var(--borderRadiusMedium);
             color: var(--neutralPrimary);
             font-weight: 500;
             cursor: pointer;
             transition: all 200ms var(--easeDecelerate);

             &:hover {
               border-color: var(--themePrimary);
               color: var(--themePrimary);
             }

             &.active {
               background: var(--themePrimary);
               border-color: var(--themePrimary);
               color: var(--white);
             }
           }
         }
       }

       .dateHeaders {
         display: flex;
         margin-top: var(--spacingL1);
         margin-left: 5rem; // Account for time column

         .dateHeader {
           flex: 1;
           text-align: center;
           padding: var(--spacingS2);
           border-bottom: 0.125rem solid transparent;
           transition: border-color 200ms var(--easeDecelerate);

           &.today {
             border-bottom-color: var(--themePrimary);
             background: var(--themeLighterAlt);
             border-radius: var(--borderRadiusSmall) var(--borderRadiusSmall) 0 0;
           }

           .dayName {
             font-size: var(--fontSizeSmall);
             font-weight: 600;
             color: var(--neutralSecondary);
             text-transform: uppercase;
             letter-spacing: 0.05em;
           }

           .dayNumber {
             font-size: var(--fontSizeLarge);
             font-weight: 600;
             color: var(--neutralPrimary);
             margin-top: var(--spacingXS);

             &.today {
               color: var(--themePrimary);
             }
           }
         }
       }
     }

     .timelineGrid {
       position: relative;
       overflow-y: auto;
       height: calc(100% - 8rem);

       .timeRow {
         display: flex;
         border-bottom: 0.0625rem solid var(--neutralLighter);

         &:hover {
           background: var(--neutralLighterAlt);
         }

         .timeLabel {
           width: 5rem;
           min-width: 5rem;
           padding: var(--spacingS2);
           background: var(--neutralLighter);
           border-right: 0.125rem solid var(--neutralQuaternaryAlt);
           color: var(--neutralSecondary);
           font-size: var(--fontSizeSmall);
           font-weight: 600;
           text-align: center;
           display: flex;
           align-items: center;
           justify-content: center;
         }

         .timeSlots {
           display: flex;
           flex: 1;

           .timeSlot {
             flex: 1;
             border-right: 0.0625rem solid var(--neutralLighter);
             min-height: 3.75rem;
             position: relative;
             transition: background-color 200ms var(--easeDecelerate);

             &:hover {
               background: var(--neutralLighterAlt);
             }

             &:last-child {
               border-right: none;
             }

             &.current-hour {
               background: linear-gradient(to right, 
                 var(--themeLighterAlt), 
                 var(--neutralLighterAlt));
             }
           }
         }
       }

       .currentTimeIndicator {
         position: absolute;
         left: 5rem;
         right: 0;
         height: 0.125rem;
         background: var(--errorText);
         z-index: var(--zIndexContent);
         box-shadow: var(--shadow4);
         border-radius: var(--borderRadiusSmall);

         &::before {
           content: '';
           position: absolute;
           left: -0.375rem;
           top: -0.25rem;
           width: 0.75rem;
           height: 0.75rem;
           background: var(--errorText);
           border-radius: 50%;
           box-shadow: var(--shadow4);
         }
       }

       .timelineEvent {
         position: absolute;
         background: var(--themePrimary);
         border-radius: var(--borderRadiusMedium);
         color: var(--white);
         padding: var(--spacingS1);
         margin: 0.0625rem;
         cursor: pointer;
         transition: all 200ms var(--easeDecelerate);
         box-shadow: var(--shadow4);
         overflow: hidden;
         z-index: calc(var(--zIndexContent) + 1);

         &::before {
           content: '';
           position: absolute;
           inset: 0;
           background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1));
           opacity: 0;
           transition: opacity 200ms var(--easeDecelerate);
         }

         &:hover {
           transform: scale(1.02);
           box-shadow: var(--shadow16);
           z-index: calc(var(--zIndexContent) + 10);

           &::before {
             opacity: 1;
           }
         }

         .eventContent {
           position: relative;
           z-index: 1;

           .eventTitle {
             font-weight: 600;
             font-size: var(--fontSizeSmall);
             line-height: 1.2;
             margin-bottom: var(--spacing2XS);
           }

           .eventTime {
             font-size: var(--fontSizeXSmall);
             opacity: 0.9;
           }

           .eventLocation {
             font-size: var(--fontSizeXSmall);
             opacity: 0.8;
             margin-top: var(--spacing2XS);
           }
         }
       }
     }
   }
 }

 // Loading States
 .loadingContainer {
   display: flex;
   flex-direction: column;
   align-items: center;
   justify-content: center;
   height: 20rem;
   background: var(--white);

   .loadingSpinner {
     width: 2.5rem;
     height: 2.5rem;
     border: 0.25rem solid var(--neutralQuaternary);
     border-top: 0.25rem solid var(--themePrimary);
     border-radius: 50%;
     animation: spin 1s linear infinite;
     margin-bottom: var(--spacingL1);
   }

   .loadingText {
     font-size: var(--fontSizeLarge);
     font-weight: 500;
     color: var(--neutralSecondary);
     text-align: center;
   }

   .loadingSubtext {
     font-size: var(--fontSizeMedium);
     color: var(--neutralTertiary);
     text-align: center;
     margin-top: var(--spacingS1);
   }
 }

 // Error States
 .errorContainer {
   display: flex;
   flex-direction: column;
   align-items: center;
   justify-content: center;
   padding: var(--spacing3XL);
   text-align: center;
   background: var(--white);

   .errorIcon {
     font-size: 4rem;
     color: var(--errorText);
     margin-bottom: var(--spacingL2);
   }

   .errorTitle {
     font-size: var(--fontSizeXXLarge);
     font-weight: 600;
     color: var(--neutralPrimary);
     margin: 0 0 var(--spacingS2) 0;
   }

   .errorMessage {
     font-size: var(--fontSizeLarge);
     color: var(--neutralSecondary);
     margin: 0 0 var(--spacingL2) 0;
     max-width: 30rem;
     line-height: 1.5;
   }

   .errorActions {
     display: flex;
     gap: var(--spacingS2);
     justify-content: center;
   }
 }

 // Modern Buttons
 .modernButton {
   display: inline-flex;
   align-items: center;
   justify-content: center;
   gap: var(--spacingS1);
   padding: var(--spacingS2) var(--spacingL1);
   background: var(--themePrimary);
   border: 0.0625rem solid var(--themePrimary);
   border-radius: var(--borderRadiusMedium);
   color: var(--white);
   font-size: var(--fontSizeMedium);
   font-weight: 500;
   text-decoration: none;
   cursor: pointer;
   transition: all 200ms var(--easeDecelerate);
   position: relative;
   overflow: hidden;

   &::before {
     content: '';
     position: absolute;
     inset: 0;
     background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1));
     opacity: 0;
     transition: opacity 200ms var(--easeDecelerate);
   }

   &:hover {
     background: var(--themeDark);
     border-color: var(--themeDark);
     transform: translateY(-0.0625rem);
     box-shadow: var(--shadow8);

     &::before {
       opacity: 1;
     }
   }

   &:active {
     transform: translateY(0);
   }

   &:focus {
     outline: 0.125rem solid var(--themePrimary);
     outline-offset: 0.125rem;
   }

   &.secondary {
     background: var(--white);
     border-color: var(--neutralQuaternary);
     color: var(--neutralPrimary);

     &:hover {
       background: var(--neutralLighterAlt);
       border-color: var(--themePrimary);
       color: var(--themePrimary);
     }
   }

   &.ghost {
     background: transparent;
     border-color: transparent;
     color: var(--themePrimary);

     &:hover {
       background: var(--themeLighterAlt);
       border-color: var(--themePrimary);
     }
   }

   &.danger {
     background: var(--errorText);
     border-color: var(--errorText);

     &:hover {
       background: #8a1c21;
       border-color: #8a1c21;
     }
   }

   &:disabled {
     opacity: 0.5;
     cursor: not-allowed;

     &:hover {
       transform: none;
       box-shadow: none;
     }
   }

   .buttonIcon {
     font-size: var(--fontSizeMedium);
   }
 }

 // Responsive Design
 @media (max-width: 768px) {
   .header {
     .headerContent {
       flex-direction: column;
       gap: var(--spacingL1);

       .titleSection {
         width: 100%;
         justify-content: center;
       }

       .headerActions {
         width: 100%;
         justify-content: space-between;
       }
     }
   }

   .commandBar {
     :global(.ms-CommandBar) {
       flex-direction: column;
       gap: var(--spacingS2);

       .ms-CommandBar-primarySet,
       .ms-CommandBar-secondarySet {
         flex-wrap: wrap;
         justify-content: center;
       }

       .ms-SearchBox {
         width: 100%;
         max-width: 20rem;
       }
     }
   }

   .viewSelector {
     :global(.ms-Pivot) {
       .ms-Pivot-link {
         padding: var(--spacingS1) var(--spacingS2);
         font-size: var(--fontSizeSmall);
       }
     }
   }

   .calendarContainer {
     :global(.rbc-calendar) {
       .rbc-toolbar {
         flex-direction: column;
         gap: var(--spacingS2);

         .rbc-toolbar-label {
           order: -1;
           font-size: var(--fontSizeLarge);
         }

         .rbc-btn-group {
           button {
             padding: var(--spacingS1) var(--spacingS2);
             font-size: var(--fontSizeSmall);
           }
         }
       }

       .rbc-month-view {
         .rbc-date-cell {
           min-height: 4rem;
           padding: var(--spacingXS);

           .rbc-date-cell-date {
             font-size: var(--fontSizeSmall);
           }
         }
       }

       .rbc-event {
         font-size: var(--fontSizeXSmall);
         padding: var(--spacing2XS) var(--spacingXS);
       }
     }
   }

   .agendaView {
     padding: var(--spacingL1);

     .eventCard {
       padding: var(--spacingS2);

       .eventHeader {
         flex-direction: column;
         align-items: flex-start;
         gap: var(--spacingS1);

         .eventBadges {
           margin-left: 0;
         }
       }
     }
   }

   .timelineView {
     .timelineHeader {
       .timelineNavigation {
         flex-direction: column;
         gap: var(--spacingS2);

         .currentPeriod {
           order: -1;
           font-size: var(--fontSizeLarge);
         }
       }

       .dateHeaders {
         margin-left: 3rem;

         .dateHeader {
           .dayName {
             font-size: var(--fontSizeXSmall);
           }

           .dayNumber {
             font-size: var(--fontSizeMedium);
           }
         }
       }
     }

     .timelineGrid {
       .timeRow {
         .timeLabel {
           width: 3rem;
           min-width: 3rem;
           font-size: var(--fontSizeXSmall);
         }
       }
     }
   }
 }

 @media (max-width: 480px) {
   .header {
     padding: var(--spacingL1);

     .headerContent {
       .titleSection {
         .titleText {
           .title {
             font-size: var(--fontSizeXLarge);
           }
         }
       }
     }
   }

   .commandBar {
     :global(.ms-CommandBar) {
       padding: var(--spacingS1) var(--spacingL1);
     }
   }

   .viewSelector {
     padding: var(--spacingS1) var(--spacingL1) 0;
   }

   .agendaView {
     padding: var(--spacingS2);

     .agendaHeader {
       flex-direction: column;
       align-items: flex-start;
       gap: var(--spacingS2);

       .agendaTitle {
         font-size: var(--fontSizeLarge);
       }
     }

     .eventCard {
       .eventDetails {
         flex-direction: column;
         gap: var(--spacingS1);
       }
     }
   }
 }

// Animations
@keyframes spin {
 0% { transform: rotate(0deg); }
 100% { transform: rotate(360deg); }
}

@keyframes pulse {
 0%, 100% { opacity: 1; }
 50% { opacity: 0.5; }
}

@keyframes slideIn {
 from {
   opacity: 0;
   transform: translateY(1rem);
 }
 to {
   opacity: 1;
   transform: translateY(0);
 }
}

@keyframes fadeIn {
 from { opacity: 0; }
 to { opacity: 1; }
}

@keyframes scaleIn {
 from {
   opacity: 0;
   transform: scale(0.9);
 }
 to {
   opacity: 1;
   transform: scale(1);
 }
}

// Apply animations
.multiCalendarAggregator {
 animation: fadeIn 300ms var(--easeDecelerate);

 .eventCard {
   animation: slideIn 200ms var(--easeDecelerate);
   animation-fill-mode: both;

   @for $i from 1 through 10 {
     &:nth-child(#{$i}) {
       animation-delay: #{$i * 50ms};
     }
   }
 }

 .agendaGroup {
   animation: scaleIn 250ms var(--easeDecelerate);
   animation-fill-mode: both;

   @for $i from 1 through 5 {
     &:nth-child(#{$i}) {
       animation-delay: #{$i * 100ms};
     }
   }
 }
}

// Focus management for accessibility
.multiCalendarAggregator {
 :focus {
   outline: 0.125rem solid var(--themePrimary);
   outline-offset: 0.125rem;
 }

 :focus:not(:focus-visible) {
   outline: none;
 }

 :focus-visible {
   outline: 0.125rem solid var(--themePrimary);
   outline-offset: 0.125rem;
 }
}

// Print styles
@media print {
 .multiCalendarAggregator {
   box-shadow: none;
   border: 0.0625rem solid var(--neutralPrimary);

   .header,
   .commandBar,
   .viewSelector {
     display: none;
   }

   .calendarContainer {
     :global(.rbc-calendar) {
       .rbc-toolbar {
         display: none;
       }

       .rbc-event {
         background: transparent !important;
         color: var(--neutralPrimary) !important;
         border: 0.0625rem solid var(--neutralPrimary) !important;
       }
     }
   }

   .agendaView {
     .eventCard {
       border: 0.0625rem solid var(--neutralPrimary);
       break-inside: avoid;
       page-break-inside: avoid;

       &::before {
         display: none;
       }
     }
   }
 }
}